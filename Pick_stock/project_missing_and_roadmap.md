# Multi-Market 项目缺口与落地路线图（审阅版）

> 目标：把当前系统从“可看/可分析”升级到“可执行/可跟踪/可验证”的产品级形态。  
> 范围：Crypto / A股 / 美股 + Selection/Research/Tracking + 回测。  
> 说明：以下为工程规划，不构成投资建议。

---

## 1. 目前项目完成度（简评）

你现在已经有：
- 多市场页面（Crypto/A股/美股）+ 关键字段展示（当前价/预测价/涨跌幅/预期日期）
- 开单信号、TP/SL、RR、回测展示
- 时间段预测页面（时段/关键小时/TopN）
- Selection / Research / Tracking 页面（筛选、规则状态、watchlist、变化提醒）

当前主要短板不是“有没有页面”，而是“实盘闭环与稳定性”。

---

## 2. 核心缺口（按重要性）

## P0（必须先做）

### 2.1 真实执行闭环
- 缺口：现在主要是信号与回测，尚未形成稳定的 `信号 -> 下单 -> 持仓 -> 平仓 -> 复盘` 流程。
- 要做：
  - 建立统一订单模型（entry/exit/status/fees/slippage）
  - 执行日志与成交回写
  - 异常处理（下单失败、重试、断线恢复）
- 验收标准：
  - 任意一个市场可完成“模拟下单到平仓”的全流程记录
  - 每笔交易有唯一 ID 和完整生命周期状态

### 2.2 组合层风控
- 缺口：当前偏单标的视角，缺少组合约束。
- 要做：
  - 总仓位上限、单标仓位上限
  - 同类资产暴露限制（行业/高相关标的）
  - 组合级止损与熔断规则
- 验收标准：
  - 新开仓前能显示“组合剩余风险预算”
  - 当超限时系统自动拒单/降仓

### 2.3 成本与交易约束分市场建模
- 缺口：成本模型统一但还不够细。
- 要做：
  - Crypto: maker/taker、perp/spot 分开
  - A股: long-only、交易时段、涨跌停/停牌约束
  - 美股: 交易时段/卖空约束/最小滑点
- 验收标准：
  - 回测与信号页都显示当前市场适用的成本/约束口径

---

## P1（强烈建议）

### 2.4 模型监控与漂移告警
- 缺口：缺少“模型最近是否失效”的自动判断。
- 要做：
  - 滚动监控：Brier / Coverage / AUC / Accuracy
  - 漂移检测：近7天 vs 近30天
  - 告警分级：正常/观察/异常
- 验收标准：
  - 页面可见“模型健康状态”
  - 指标异常时自动产生告警记录

### 2.5 回测一致性与防泄漏审计
- 缺口：需要更系统地证明“没有未来函数、可复现”。
- 要做：
  - walk-forward 审计模板
  - 特征可用时点校验（timestamp alignment）
  - 回测版本快照（配置/数据/模型版本）
- 验收标准：
  - 任意一份回测结果可追溯到配置与数据版本

### 2.6 数据工程稳定性
- 缺口：缺自动补数、重试、任务编排的统一策略。
- 要做：
  - 定时任务（拉数、预测、回测、报告）
  - 失败重试与降级策略
  - 数据完整性检查（缺失率、历史长度）
- 验收标准：
  - 任务失败有明确告警并可自动重试
  - 每日可产出完整 snapshot

---

## P2（增强项）

### 2.7 解释层统一化
- 缺口：不同页面解释口径仍有轻微分散。
- 要做：
  - 统一顶部“决策卡”模板
  - 统一术语解释（小白友好）
- 验收标准：
  - 三个市场页的信息结构一致

### 2.8 测试与发布流程
- 缺口：缺少系统化 CI/CD 保障。
- 要做：
  - 单元测试（指标、信号、回测核心函数）
  - 回归测试（关键页面数据断言）
  - 发布前检查清单
- 验收标准：
  - 核心模块有基本测试覆盖
  - 发布前自动跑校验

---

## 3. 两周落地排期（建议）

## 第1周（把系统变“可执行”）

### Day 1-2
- 统一交易对象模型（订单/成交/持仓）
- 实现模拟执行流水（paper trading）

### Day 3-4
- 加组合风控（仓位上限、暴露限制、组合止损）
- 三市场成本与交易约束口径落地

### Day 5
- 页面接入执行状态与风控结果（可视化）
- 内部联调与问题修复

交付物：
- Paper trading 最小闭环可跑
- 组合级风险控制生效

## 第2周（把系统变“可验证、可持续”）

### Day 6-7
- 模型健康面板（Brier/Coverage/AUC）
- 漂移告警与状态分级

### Day 8-9
- 回测审计（防泄漏/版本快照）
- 报告导出（策略表现 + 版本信息）

### Day 10
- 自动任务编排（拉数/预测/回测/报告）
- 测试与发布清单落地

交付物：
- 可靠性监控 + 告警
- 回测可追溯与基础自动化

---

## 4. 里程碑验收（你可以直接拿来过项目）

### M1（执行闭环）
- 能稳定产出纸上交易记录（开仓/平仓/成本/原因）
- 页面能看到当前持仓、历史交易、执行失败原因

### M2（风险闭环）
- 新开仓前有风险预算检查
- 超限自动阻断并提示原因

### M3（可信闭环）
- 能展示近30天模型健康分数
- 回测结果可追溯到模型与数据版本

### M4（运维闭环）
- 每日自动运行任务
- 异常有告警和可恢复策略

---

## 5. 你现在最该先做的 5 件事（高性价比）

1. 落地 paper trading 交易流水（先只做一个市场也行）  
2. 上组合风控（总仓位/单标/暴露）  
3. 三市场成本与交易约束分开建模  
4. 增加模型健康面板（Brier + Coverage）  
5. 做回测版本追溯（model/data/config hash）

---

## 6. 备注

- 如果你目标是“研究展示”，做到 P1 基本就很强。  
- 如果你目标是“接近实盘”，P0 必须优先完成。  
- 建议保持“先小闭环、再扩市场”的节奏：先在 Crypto 跑通完整链路，再推广到 A股/美股。

